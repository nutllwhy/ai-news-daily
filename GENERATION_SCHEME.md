# 📋 栗噔噔AI早报 - 生成方案（V2.0 - 带去重功能）

## 🔄 去重机制

### 核心原则
**昨天写过的新闻，今天绝不再写**

### 去重记录文件
```
reported_news.json
```

**记录内容**：
- 每条已报道新闻的标题
- 关键词标签（用于模糊匹配）
- 来源URL
- 报道日期

### 去重规则

#### 1. 精确去重（优先级：最高）
| 匹配类型 | 判定标准 | 处理方式 |
|---------|---------|---------|
| **URL重复** | 相同链接 | ❌ 直接排除 |
| **标题重复** | 标题完全一致 | ❌ 直接排除 |
| **标题相似** | 相似度≥70% | ❌ 直接排除 |

#### 2. 关键词去重（优先级：高）
| 匹配标准 | 处理方式 |
|---------|---------|
| 关键词重合≥3个 | ❌ 视为重复新闻 |
| 关键词重合2个+时间相同 | ❌ 视为重复新闻 |

**示例**：
- 昨天："OpenAI宣布GPT-4o退役" [关键词：OpenAI, GPT-4o, 退役]
- 今天："GPT-4o正式下架，OpenAI推进升级" [关键词：GPT-4o, OpenAI, 下架]
- 结果：关键词重合3个 → 判定重复 → ❌ 不写

#### 3. 内容去重（优先级：中）
| 场景 | 处理方式 |
|-----|---------|
| 同一事件的不同角度报道 | 只选最权威/最新的一条 |
| 官方公告 vs 媒体解读 | 优先官方，媒体解读作为补充 |
| 英文源 vs 中文源 | 优先中文源，方便读者理解 |

#### 4. 时效去重（优先级：低）
- **7天内**报道过的新闻：严格去重
- **7天以上**的旧闻：可视为"进展更新"重新报道

### 例外情况（可重复报道）

#### ✅ 允许重复的情况
1. **重大进展**：同一事件有了重大新进展
   - 昨天："OpenAI宣布退役GPT-4o"
   - 今天："GPT-4o退役引发开发者抗议潮"
   
2. **后续影响**：同一事件的后续影响/市场反应
   - 昨天："苹果被曝使用Claude"
   - 今天："Anthropic股价因苹果消息大涨20%"
   
3. **深度解读**：对已报道事件的深度分析/独家解读
   - 需明确标注"昨日事件的深度分析"

#### ❌ 不允许重复的情况
- 单纯换了个标题的同一新闻
- 不同媒体对同一事件的重复报道
- 没有新信息的"跟进报道"

---

## 🔍 检索策略（V2.0）

### 检索前准备
1. **读取历史记录**：加载 `reported_news.json`
2. **提取关键词**：获取昨天所有报道的关键词
3. **建立黑名单**：生成今天需要排除的关键词组合

### 检索流程

#### 第一轮：通用AI新闻
```
搜索词：AI artificial intelligence news today
数量：15条（预留去重余量）
筛选：
  - 过去24小时内
  - 排除已报道关键词
  - 排除股价/财报类新闻
```

#### 第二轮-第六轮：各平台动态
```
搜索词：[各平台关键词]
数量：每条15条
筛选：
  - 对比reported_news.json
  - 标题相似度检查
  - 关键词重合检查
```

### 实时去重检查
每搜到一条新闻，立即检查：
```
1. URL是否在记录中？ → 是 → 丢弃
2. 标题相似度≥70%？ → 是 → 丢弃  
3. 关键词重合≥3个？ → 是 → 丢弃
4. 7天内报道过同一事件？ → 是 → 丢弃
5. 通过所有检查 → ✅ 保留
```

---

## ✍️ 撰写规范（V2.0）

### 新增步骤：去重确认
在撰写每条新闻前，再次确认：
```
⚠️ 检查：这条新闻昨天写过吗？
⚠️ 检查：这个事件7天内报道过吗？
⚠️ 检查：这只是换了个标题的重复新闻吗？
```

### 如果发现今天新闻不足
如果因为去重导致今天可写的新闻少于3条：

**处理方案**：
1. **扩大搜索范围**：
   - 搜索更广泛的AI话题
   - 查看科技大厂的其他动态
   - 查看AI在垂直领域的应用（医疗、教育、金融）

2. **降低严格度**：
   - 7天前的旧闻如果有重大进展可重新报道
   - 同一事件的不同角度可简要提及

3. **备选内容**：
   - AI历史上的今天
   - 即将发生的重要AI事件预告
   - 经典论文重读/技术原理解析

---

## 📊 输出物更新

### 1. 微信群发消息
- 纯文本，1000字以内
- 无重复内容（已通过去重检查）

### 2. HTML完整版
- 精美排版
- 历史归档

### 3. reported_news.json（自动更新）
每天生成日报后自动追加：
```json
{
  "date": "2026-02-01",
  "headlines": [...],
  "tools": [...],
  "research": [...]
}
```

### 4. 去重统计日志（可选）
```
今日检索：52条新闻
去重排除：18条（34.6%）
实际采用：8条
  - 头条：3条
  - 工具：2个  
  - 研究：1个
```

---

## 🧪 去重测试示例

### 测试案例1：标题相似
```
昨天：OpenAI宣布永久退役GPT-4o模型
今天：OpenAI正式下架GPT-4o，用户需尽快迁移

关键词重合：OpenAI, GPT-4o, 退役/下架
判定：❌ 重复（关键词3个重合）
```

### 测试案例2：同一事件不同角度
```
昨天：OpenAI宣布退役GPT-4o
今天：GPT-4o退役引发开发者社区热议

分析：有新增信息（社区反应）
判定：✅ 可写（标记为"昨日事件的后续"）
```

### 测试案例3：不同事件但关键词相似
```
昨天：Google发布Gemini新功能
今天：Google DeepMind发布新研究论文

关键词重合：Google
判定：✅ 可写（只有1个关键词重合，且是不同事件）
```

---

## 📈 去重效果预期

| 指标 | 目标值 |
|------|--------|
| 日报重复率 | <5% |
| 7天内同一事件重复报道 | 0次 |
| 因去重导致内容不足天数 | <10% |

---

这个方案可以确保你的日报每天都是新鲜内容，不会出现"昨天写过的今天又写"的尴尬情况。需要我调整任何细节吗？